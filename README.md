重构：改善既有代码的设计
-----------------------

重构：对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高其可理解性，降低其修改成本。

重构：使用一系列重构手法，在不改变软件可观察行为的前提下，调整其结构。

# Tips
- 如果你发现自己需要为程序添加一个特性，而代码结构使你无法很方便地达成目的，那就先重构那个程序，使特性的添加比较容易进行，然后再添加特性。
- 重构的第一步：为即将修改的代码建立一组可靠的测试环境。重构之前，首先检查自己是否有一套可靠的测试机制。这些测试必须有自我检验能力。
- 重构技术就是以微小的步伐修改程序。如果你发现错误，很容易便可发现它。
- 任何一个傻瓜都能写出计算机可以理解的代码。唯有写出人类容易理解的代码，才是优秀的程序员。更改变量名称，提高代码清晰度。代码应该表现自己的目的。
- 尽量去除一些无意义的临时变量，临时变量往往引发问题，会导致大量参数被传来传去，很容易跟丢它们，尤其在长长的函数中。
- 两顶帽子：重构时应该把时间分配给两种行为：添加新功能和重构。添加新功能不能修改既有代码，只添加新功能；重构不能再添加新功能，只管改进程序结构，此时也不应添加任何测试。
- 代码结构的流失是累积性的。越难看出代码所代表的设计意图，就越难保护其中的设计。
- 消除重复代码：代码越多，正确的修改就越困难。
- "准确说出我想要的"。
- 重构使代码更容易理解和阅读。重构可以帮助我们写出更强健的代码。重构帮助我们快速地开发程序。
- 三次法则：事不过三，三则重构
    - 第一次做某件事时只管去做
    - 第二次做类似的事情就会产生反感，但无论如何还是可以去做
    - 第三次再做类似的事情，就应该重构
- 重构时机：
    - 添加功能时重构
    - 修补错误时重构：如果收到一份错误报告，这就是重构的信号
    - 复审代码时重构
- 难以阅读的代码，难以修改
- 逻辑重复的代码，难以修改
- 添加新行为时需要修改已有代码的程序，难以修改
- 带复杂条件逻辑的程序，难以修改
- 好程序的特性：
    - 容易阅读
    - 所有逻辑都只在唯一地点指定
    - 新的改动不会危及现有行为
    - 尽可能简单表达条件逻辑

